<%# app/views/client_sessions/index.html.erb %>

<div class="container mx-auto p-4">
  <h1 class="text-3xl font-bold text-gray-800 mb-6">Active Hotspot Sessions</h1>

  <div class="bg-white p-6 rounded-lg shadow-md">
    <div class="flex justify-between items-center mb-4">
      <h2 class="text-xl font-semibold text-black">Live Session Data</h2>
      <span class="text-sm text-gray-500">Last updated: <span id="last-updated-time"><%= Time.current.strftime('%H:%M:%S') %></span></span>
    </div>

    <%# The Turbo Frame that will automatically refresh %>
    <%# data-turbo-frame-reload: "true" with data-turbo-frame-reload-interval: "5000" (5 seconds) %>
    <%# Will automatically reload content from its `src` URL %>
   <%= render partial: "active_sessions_table" %>

    <p class="text-sm text-black mt-6">
      This table updates automatically to show current active sessions.
      "Data In/Out" values reflect total traffic for the session.
    </p>
  </div>
</div>

<%# Optional: JavaScript to update the "Last updated" timestamp %>
<script type="module">
  document.addEventListener('turbo:frame-load', (event) => {
    if (event.target.id === 'active_sessions_table') {
      const now = new Date();
      document.getElementById('last-updated-time').textContent = now.toLocaleTimeString();
    }
  });
</script>

