<section class="min-h-screen flex flex-col justify-between bg-gradient-to-br from-blue-50 to-indigo-100 dark:bg-gray-900 py-12 px-4 sm:px-6 lg:px-8">
    <div class="flex-grow flex items-center justify-center">
        <div class="bg-white p-8 rounded-xl shadow-2xl w-full md:max-w-lg text-center border border-gray-200 dark:bg-gray-800 dark:border-gray-700">
            <h1 class="text-3xl sm:text-4xl font-extrabold text-gray-900 dark:text-gray-100 mb-4 animate-fade-in">Payment Confirmation</h1>
            <p class="text-lg text-gray-700 dark:text-gray-300 mb-6 leading-relaxed">
                Please check your phone for the <strong class="text-blue-600 dark:text-blue-400">M-Pesa prompt</strong> and approve the payment to complete your transaction.
            </p>

            <div class="relative flex items-center justify-center h-20 w-20 mx-auto mb-8">
                <!-- Outer ring (static) -->
                <div class="absolute inset-0 rounded-full border-4 border-gray-200 dark:border-gray-700"></div>
                <!-- Inner spinning ring -->
                <div class="animate-spin rounded-full h-full w-full border-t-4 border-b-4 border-blue-500 dark:border-blue-400"></div>
                <!-- Optional: Add a small icon in the center, e.g., a phone or checkmark -->
                <svg class="absolute h-8 w-8 text-blue-500 dark:text-blue-400" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z" />
                </svg>
            </div>

            <p class="text-gray-800 dark:text-gray-200 font-semibold mb-2 text-lg">Waiting for M-Pesa confirmation...</p>
            <p class="text-gray-500 dark:text-gray-400 text-sm mb-6">Do not close this page. You will be redirected automatically.</p>

            <div data-controller="polling"
            data-polling-url-value="<%= hotspot_payment_status_path(transaction_id: @transaction.id) %>"
            data-polling-interval-value="3000"> <%# Poll every 3 seconds %>
                <%# Turbo Frame to poll for status updates %>
                <%= turbo_frame_tag "payment_status", class: "block w-full" do %>
                    <p class="text-blue-600 dark:text-blue-400 text-base font-medium">Establishing secure connection...</p>
                    <div class="w-full bg-gray-200 rounded-full h-2.5 dark:bg-gray-700 mt-3">
                        <div class="bg-blue-600 h-2.5 rounded-full animate-pulse-width" style="width: 25%"></div> <%# Example width, can be dynamic if desired %>
                    </div>
                <% end %>

                <%# Hidden div that Turbo Stream might target for redirection %>
                <div id="redirection_target" class="hidden"></div>
            </div>
        </div>
    </div>



    <!-- Footer or other relevant content can go here -->
    <footer class="py-4 text-center text-gray-600 dark:text-gray-400 text-sm">
        &copy; <%= Time.current.year %> Centerline Hotspot. All rights reserved.
    </footer>
</section>

<style>
/* Custom animations for the page */
@keyframes fade-in {
    from { opacity: 0; transform: translateY(-10px); }
    to { opacity: 1; transform: translateY(0); }
}

@keyframes pulse-width {
    0%, 100% { width: 25%; } /* Start and end at 25% */
    50% { width: 75%; }      /* Expand to 75% in the middle */
}

.animate-fade-in {
    animation: fade-in 0.8s ease-out forwards;
}

.animate-pulse-width {
    animation: pulse-width 2s infinite ease-in-out;
}
</style>
